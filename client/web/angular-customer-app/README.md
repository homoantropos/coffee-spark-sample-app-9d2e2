# AI Barista - an Agentic AI sample app

Welcome to the AI Barista sample app, an agent-powered web app for ordering beverages! It's an Angular app built using [Firebase AI Logic](https://firebase.google.com/docs/ai-logic).

AI Barista uses a Firebase AI Logic, powered by Gemini, to create an intelligent chatbot that simulates a coffee shop ordering experience. The agent is designed to understand natural language, manage a multi-turn conversation, ask clarifying questions, and build a final order.

The backend of AI Barista is powered by [Firebase](https://firebase.google.com/), which is Google's platform for building fullstack multi-platform apps. This app uses [Firebase Authentication](https://firebase.google.com/products/auth) for signing-in users, and [Firestore](https://firebase.google.com/products/firestore) to store order data in a NoSQL database.

> If you want to deploy or use this as a basis for a production app,
> **we strongly recommend that you add [Firebase App Check](https://firebase.google.com/products/app-check) to protect your app from abuse and blocking traffic without valid credentials.

## Explore the app's codebase
- In `client/web/angular-customer-app/`, you can find the frontend customer ordering app, built with Angular.
    - The Firebase configuration is located in `src/environments/environment.development.ts`.
- Note that if you
  [run the sample app in Firebase Studio](https://github.com/FirebaseExtended/solution-ai-barista/blob/decafe/client/web/angular-customer-app/README.md#set-up-and-run-the-app),
  then these config values will be automatically populated into the `src/bootstrap.js` file for you.
- In `src/app/services/coffee.service.ts`, you can explore how to make a basic call to
  the Firebase AI Logic API, including:

  - Initializing the Google AI service and the generative model.
  - Calling `startChat` to send the agentic request to Gemini with the provided prompt
    (and image, if selected).
- In `src/app/app.config.ts` and `src/app/services/coffee.service.ts`, you can explore
  how to use Firebase, including:

  - Using Firebase Authentication's
    [anonymous authentication method](https://firebase.google.com/docs/auth/web/anonymous-auth)
    to create an authenticated user account.
  - Using Firestore to write and read to-do tasks and subtasks generated by Gemini.

## Set up and run the app

You can either run the sample app in Firebase Studio (recommended) or locally.

### Option 1: Run in Firebase Studio _(recommended)_
This AI Barista web app is best experienced by running it in Firebase Studio, which is Google's browser-based workflow for building with Firebase. This workflow helps you quickly experiment with the sample app.

<a href="https://console.firebase.google.com/?idxSampleProjectTemplateId=barista&dlAction=IdxSampleProject">
  <picture>
    <source
      media="(prefers-color-scheme: dark)"
      srcset="https://cdn.firebasestudio.dev/btn/try_dark_32.svg">
    <source
      media="(prefers-color-scheme: light)"
      srcset="https://cdn.firebasestudio.dev/btn/try_light_32.svg">
    <img
      height="32"
      alt="Try in Firebase Studio"
      src="https://cdn.firebasestudio.dev/btn/try_blue_32.svg">
  </picture>
</a>

You can also kick-off this custom workflow from the Firebase console in the
_Build with Gemini_ section (find the "Experiment with a Gemini sample app" banner).

Here's some additional information about this custom workflow:

- To somewhat protect your Gemini API key, the workflow has imposed a quota limit on the
  API key of 10 RPM.
- This workflow creates a new workspace. If you run out of workspace quota, go to
  [firebase.studio](https://firebase.studio/) to delete an old workspace.

### Option 2: Run locally

You can also run this _Planning with the Gemini API_ web app locally. You'll just need
to complete some manual setup steps.

#### Prerequisites

- Node.js v20+
- npm v10+
- Angular CLI 18+

#### Setup instructions

1.  Set up Firebase:
    a. Create a new Firebase project in the
    [Firebase console](https://console.firebase.google.com/).
    You can skip setting up Google Analytics.
    b. Enable [Firestore](https://console.firebase.google.com/u/0/project/_/firestore)
    and [anonymous authentication](https://console.firebase.google.com/u/0/project/_/authentication)
    in your new project.
    c. Create a new Firebase web app in your new project.
    You can skip setting up Firebase Hosting.
    d. Copy your Firebase config object, and replace the placeholder values in the
    `client/web/angular-customer-app/src/bootstrap.js` file of the sample app.

2.  Set up the Gemini API:
    a. [Get a Gemini API key](https://aistudio.google.com/app/apikey) in Google AI Studio.
    Use the Firebase project you just created.
    b. Add your Gemini API key into the `client/web/angular-customer-app/src/bootstrap.js` file of the sample app.

3.  cd to `client/web/angular-customer-app/` and run `npm install` to install the app's dependencies.

4.  Serve the app:
    a. Run `ng serve` to start the Angular development server.
    b. Open your browser and navigate to `http://localhost:4200`.

## Interact with the app

1.  Ask for Barista's recommendation.\
    Click on one of the images in the pop up modal, and click send, or enter a scenario in the text box for a recommendation.

2.  Add to order.\
    Send a chat message to add an item from the menu to order, and then choose modifiers including milk and sugar.

3.  Ask the Barista to submit the current order to save to Firestore.

Here are some example messages to try.

### Orders

```text
I want to order a latte with oat milk and double shots.
Add 1 latte, regular milk, 1 shot, no sweeteners to the order.
Order a cappucino with almond milk and extra sugar.
I'd like a decaf almond cappuccino, double shots with chocolate sauce.
Add a cortado with with quadruple shots, iced, regular milk and a Matcha Latte with extra foam, hazelnut sauce and sugar free vanilla sweetener.
Order 1 latte with oat milk, 2 shots and a latte, regular milk, 1 shot with sugar.
```

### Updating orders

```text
Actually, instead of the Latte I'd like an espresso. Make it extra hot.
I want oat milk instead.
Clear my order and let me start again.
```

### Order submission and status check

```text
What's my order?
Submit my order
```

## Migrate to use Genkit and Cloud Run
This sample app is a client side version of the [AI Barista app](https://github.com/FirebaseExtended/solution-ai-barista/tree/main). This solution offers a backend approach using [Genkit](https://genkit.dev/)and [Cloud Run](https://genkit.dev/go/docs/cloud-run/) for a scalable serverless backend.

Checkout [AI Barista's codebase](https://github.com/FirebaseExtended/solution-ai-barista/tree/main) and the [accompanying guide](https://developers.google.com/solutions/learn/agentic-barista) if you wish to use a secured backend-driven approach.

## Delete and clean up deployed services

To avoid continued billing for the resources that you have created as part of trying out this demo app, delete the Firebase project or disable the deployed services.

If you have created a new project to test this app, follow [these steps to delete the project](https://support.google.com/firebase/answer/9137886?hl=en) through the Firebase console.

Follow security best practices by cleaning up your Firebase project and sample app:

    - If you're no longer using your Gemini API key, then delete it.

      - In the [**API keys** section of Google AI Studio](https://aistudio.google.com/app/apikey),
        view and delete your Gemini API key.
      - In the sample app's codebase, delete references to the Gemini API key in the following places:
        - `google_apikeys_key` resource entry in `main.tf`
        - `geminiApiKey` in both `src/bootstrap.js` and `src/bootstrap.js.tmpl`

    - If you're no longer using the Google AI Gemini API, then disable it in your project
      and delete references to it in your sample app's codebase:
      - Disable the API in the Google Cloud console:
        [generativelanguage.googleapis.com](https://console.cloud.google.com/apis/library/generativelanguage.googleapis.com?project=_)
      - Delete references to `generativelanguage.googleapis.com`, including the
        `google_service_usage_consumer_quota_override` resource entry in `main.tf`.

## Docs

- [Firebase Support](https://firebase.google.com/support)
- [Firebase AI Logic](https://firebase.google.com/docs/ai-logic)
